# ConcordCloud
<a href="https://deepwiki.com/Phoen1xCode/ConcordCloud"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>

## 产品介绍
轻量级文件上传、下载和共享的Web网页解决方案

## 具体功能

### 核心功能

1. 用户注册和登录
- 用户可通过填写邮箱、设置密码完成注册流程。
- 用户可通过登录页面进行登录。
- (暂时不打算)支持第三方登录
2. 文件上传和下载
- 用户可通过点击 “上传文件” 按钮，选择本地文件进行上传。
- 平台支持多种常见格式，包括但不限于 PDF（适用于文档分享）、图片（如 JPEG、PNG 等，适合照片、设计图分享）、视频（如 MP4，方便分享视频资料）等。
- 对于已上传到平台的文件，用户可在文件列表中找到对应文件，点击 “下载” 按钮即可将文件下载到本地设备。
3. 文件分享
- 用户选择需要分享的文件，点击 “生成分享密码” 按钮，即可为该文件生成唯一的分享密码，分享文件有效期可自定义设置。
- 登录用户和非登录用户可通过输入分享密码直接下载文件，无需下载客户端或者额外进行注册登录。
4. 文件管理
- 用户登录后，可在个人文件页面查看已上传的所有文件列表，列表展示文件名称、上传时间、文件大小等信息。
- 支持对文件进行重命名操作，右键点击文件选择 “重命名”，输入新名称即可；对于不再需要的文件，可选择文件后点击 “删除” 按钮进行删除。
- 文件可按类型（如将所有 PDF 文件归为一类、图片归为一类）或上传时间（按最新上传到最早上传排序）进行分类展示，方便用户查找和管理文件。
5. 用户权限控制
- 平台设置不同用户角色，主要为普通用户和管理员。
- 管理员拥有最高权限，可管理平台上所有文件，包括查看、编辑、删除任何用户上传的文件。
- 普通用户仅能管理自己上传的文件，如查看、重命名、删除自己的文件，无法对其他用户文件进行操作。

### 拓展功能

## 技术实现

本项目采用前后端分离的架构设计，前端基于 Vue.js 框架，后端基于 ASP.NET Core .NET 9.0 构建 Web API。

### 前端

- **开发框架及工具**
  - **Vue.js**：采用 Vue.js 构建页面，充分利用组件化开发、响应式数据绑定和虚拟 DOM 技术。
  - **Vue Router**：实现前端路由控制，根据用户权限（登录用户和非登录用户）动态加载对应页面，例如登录页、文件列表页、上传页等。
  - **Vuex**：进行全局状态管理，如用户信息、文件列表、上传状态等，保证不同组件间状态共享和联动。
  - **Vite**：使用 Vite 作为构建工具，加快项目编译和热更新速度。
  - **Axios**：用于与后端 API 进行 HTTP 通讯，实现文件上传、下载、用户认证、文件管理等请求的交互。

- **文件上传与下载**
  - **上传组件**：封装文件选择、上传进度展示、错误处理等功能。支持多种常见文件格式，并在上传时进行格式和大小校验。
  - **断点续传（可选拓展）**：对于大文件上传，可考虑集成断点续传方案，以提升用户体验。
  - **下载处理**：点击“下载”按钮时，通过调用相应 API 获取文件流，利用 Blob 对象实现无插件跨浏览器下载。

- **文件分享功能**
  - 前端调用生成分享密码的 API，并支持自定义分享密码的有效期设置。
  - 分享页面支持输入分享密码后调用 API 验证，并下载对应文件。

- **响应式设计与用户交互**
  - 采用响应式布局设计，兼容不同设备（PC、平板、移动端）。
  - 对重要操作（如删除、重命名）增加确认弹窗，提升用户体验和安全性。


### 后端

- **架构与项目组织**
  - 后端项目按照职责分离，分为 Web API 层（ConcordCloud.API）、核心业务逻辑层（ConcordCloud.Core）和数据访问层（ConcordCloud.Data）。
  - 统一采用 ASP.NET Core 构建 API 服务，利用依赖注入（DI）进行模块解耦，确保代码清晰易于单元测试。

- **用户认证与授权**
  - **用户注册和登录**：采用 ASP.NET Core Identity 实现用户管理，支持基于邮箱和密码的注册登录流程。可通过 JWT（JSON Web Token）为用户生成令牌，保障 API 调用安全。
  - **权限控制**：通过角色（普通用户和管理员）控制接口访问权限，管理员可管理所有用户文件，普通用户仅能操作自己的文件。利用 ASP.NET Core 内置 [Authorize] 特性及策略授权实现细粒度权限控制。

- **文件管理**
  - **文件上传**：利用 ASP.NET Core 提供的文件流处理接口（如 IFormFile），实现文件上传接口。上传后的文件存储在服务器指定目录（或日后采用云存储组件），同时将文件元数据（文件名、大小、上传时间、所属用户、文件路径和类型等）记录到数据库中。
  - **文件分享**：文件分享功能采用随机生成唯一分享密码；前端请求时调用 API 返回经过加密后的分享链接及有效期。系统在下载验证阶段对分享密码及有效期进行校验。
  - **文件下载**：在用户请求下载时，根据文件物理路径读取文件流，使用适当的 MIME 类型返回给客户端。对于分享下载，使用匿名接口对有效分享密码进行验证后放行。

- **数据访问**
  - 采用 Entity Framework Core 作为 ORM 框架，数据访问层（ConcordCloud.Data）封装所有数据库操作，使业务逻辑层无需直接操作数据库。
  - 数据库设计包含用户表、文件元数据表和文件分享记录表，确保文件相关操作的高性能和数据一致性。

- **错误处理与日志记录**
  - 全局异常处理中间件统一捕获异常，返回标准化错误格式至前端。
  - 利用内置或第三方日志组件（如 Serilog）记录关键操作日志，便于日后排查问题和审计操作。

- **安全性与性能优化**
  - **安全性**：针对文件上传接口进行文件格式校验和大小限制，防止恶意文件上传。通过配置跨域策略（CORS）允许安全的前后端交互。对于公开 API，采用 HTTPS 保障数据传输安全。
  - **性能优化**：对大文件读取、文件下载进行流式传输，避免服务器内存压力过大。可针对频繁访问的分享文件进行缓存处理（如内存缓存或 CDN 分发）。

---

### 部署与环境

- **开发环境**
  - 前端采用 Node.js 环境，通过 Vite 启动开发服务器进行调试。
  - 后端在本地开发环境下利用 Kestrel 或 IIS Express 运行，方便调试 API。

- **生产环境**
  - 前后端分别打包，后端部署到Docker容器。前端可以部署在静态网站托管平台或 CDN 上，确保文件上传/下载速度。
  - 数据库使用PostgreSQL

- **持续集成与自动化部署**
  - 配置 CI/CD 管道（如 GitHub Actions、Jenkins 或 Azure DevOps），实现代码提交、自动化测试、构建打包和部署，提升开发效率和代码质量。

---

### 项目目录结构


```
ConcordCloud/
├── backend/                      # 后端项目
│   ├── ConcordCloud.API/         # Web API 项目（包含所有控制器、接口、全局配置及中间件）
│   ├── ConcordCloud.Core/        # 核心业务逻辑（业务层，封装具体业务规则和服务层接口实现）
│   ├── ConcordCloud.Data/        # 数据访问层（包含 EF Core 上下文、数据库实体、仓储模式实现等）
│   └── ConcordCloud.sln          # 解决方案文件
│
├── frontend/                     # 前端项目
│   ├── public/                   # 静态资源
│   ├── src/                      # 源代码
│   │   ├── assets/               # 资源文件（如 CSS、图片等）
│   │   ├── components/           # Vue组件（如上传文件、文件列表、文件卡片等）
│   │   ├── router/               # 路由配置（保护路由和权限控制）
│   │   ├── store/                # 状态管理（Vuex/Pinia 实现全局数据管理）
│   │   ├── views/                # 页面（如首页、登录页、注册页、用户文件管理页、文件分享页等）
│   │   ├── App.vue               # 根组件
│   │   └── main.js               # 入口文件
│   ├── package.json              # 依赖配置
│   └── vite.config.js            # Vite 配置文件
│
└── README.md                     # 项目说明及部署注意事项
```

---
